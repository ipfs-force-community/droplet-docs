(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{426:function(t,a,s){"use strict";s.r(a);var e=s(17),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"快速启用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速启用"}},[t._v("#")]),t._v(" 快速启用")]),t._v(" "),s("h2",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),s("p",[s("code",[t._v("droplet")]),t._v(" 是 "),s("code",[t._v("venus")]),t._v(" 系统中的市场服务组件，由两部分组成："),s("code",[t._v("droplet")]),t._v(" 和 "),s("code",[t._v("droplet-client")]),t._v("，通俗理解为市场服务端和客户端。")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("droplet")]),t._v(" 的服务对象是存储提供商；")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("droplet-client")]),t._v(" 的服务对象是有检索需求或存储需求的用户。")])])]),t._v(" "),s("p",[s("code",[t._v("droplet")]),t._v(" 的市场服务分为存储市场和检索市场，其一般流程如下：")]),t._v(" "),s("ul",[s("li",[t._v("存储流程：")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("阶段")]),t._v(" "),s("th",[t._v("步骤")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("启动 "),s("code",[t._v("droplet")]),t._v(" 和 "),s("code",[t._v("droplet-client")])]),t._v(" "),s("td",[t._v("1. "),s("a",{attrs:{href:"###droplet%E5%88%9D%E5%A7%8B%E5%8C%96%E5%B9%B6%E5%90%AF%E5%8A%A8"}},[t._v("droplet初始化并启动")]),t._v(" "),s("br"),t._v("2.  "),s("a",{attrs:{href:"###droplet-client%E5%88%9D%E5%A7%8B%E5%8C%96%E5%B9%B6%E5%90%AF%E5%8A%A8"}},[t._v("droplet-client初始化并启动")])])]),t._v(" "),s("tr",[s("td",[t._v("代理 "),s("code",[t._v("miners")]),t._v(" 的 "),s("code",[t._v("libp2p")]),t._v(" 监听服务")]),t._v(" "),s("td",[t._v("3. "),s("a",{attrs:{href:"###%E8%AE%BE%E7%BD%AEdroplet%E4%BF%A1%E6%81%AF%E5%88%B0%E7%BD%91%E7%BB%9C"}},[t._v("设置droplet信息到网络")])])]),t._v(" "),s("tr",[s("td",[t._v("为 "),s("code",[t._v("miners")]),t._v(" 挂单")]),t._v(" "),s("td",[t._v("4. "),s("a",{attrs:{href:"####%E5%AD%98%E5%82%A8%E6%8C%82%E5%8D%95"}},[t._v("存储挂单")])])]),t._v(" "),s("tr",[s("td",[t._v("指定 "),s("code",[t._v("miner")]),t._v(" 发单")]),t._v(" "),s("td",[t._v("5. "),s("a",{attrs:{href:"###%E5%AD%98%E5%82%A8%E8%AE%A2%E5%8D%95%EF%BC%88%E5%8F%91%E5%8D%95%EF%BC%89"}},[t._v("存储发单")])])])])]),t._v(" "),s("p",[t._v("发单之后，需要一定时间执行订单交易流程，订单被确认后，存储提供商对订单中数据进行封装并提交证明，"),s("code",[t._v("droplet")]),t._v(" 负责跟踪订单状态。")]),t._v(" "),s("ul",[s("li",[t._v("检索流程：")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("阶段")]),t._v(" "),s("th",[t._v("步骤")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("启动 "),s("code",[t._v("droplet")]),t._v(" 和 "),s("code",[t._v("droplet-client")])]),t._v(" "),s("td",[t._v("1. "),s("a",{attrs:{href:"###droplet%E5%88%9D%E5%A7%8B%E5%8C%96%E5%B9%B6%E5%90%AF%E5%8A%A8"}},[t._v("droplet初始化并启动")]),t._v(" "),s("br"),t._v("2.  "),s("a",{attrs:{href:"###droplet-client%E5%88%9D%E5%A7%8B%E5%8C%96%E5%B9%B6%E5%90%AF%E5%8A%A8"}},[t._v("droplet-client初始化并启动")])])]),t._v(" "),s("tr",[s("td",[t._v("设置检索价格及收款地址")]),t._v(" "),s("td",[t._v("3. 存储供应商通过 "),s("code",[t._v("droplet")]),t._v(" "),s("a",{attrs:{href:"####%E6%A3%80%E7%B4%A2%E6%8C%82%E5%8D%95"}},[t._v("检索挂单")])])]),t._v(" "),s("tr",[s("td",[t._v("提交数据检索订单")]),t._v(" "),s("td",[t._v("4. "),s("a",{attrs:{href:"#%E6%8F%90%E4%BA%A4%E6%95%B0%E6%8D%AE%E6%A3%80%E7%B4%A2%E8%AE%A2%E5%8D%95"}},[t._v("提交数据检索订单")])])])])]),t._v(" "),s("p",[t._v("提交数据检索订单之后，开始执行检索交流流程，会按照协议分批次回传数据并将所需费用转给收款地址")]),t._v(" "),s("p",[t._v("💁 "),s("strong",[t._v("无论是存储交易还是检索交易，其协议的执行过程都是自动的，期间会发送消息上链，故需保证交易双方的消息都可以正常签名。交易过程存在必要的 "),s("code",[t._v("fil")]),t._v(" 流转，相关地址需要有足够的余额，否则交易将无法达成。")])]),t._v(" "),s("h2",{attrs:{id:"droplet"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#droplet"}},[t._v("#")]),t._v(" droplet")]),t._v(" "),s("h3",{attrs:{id:"droplet初始化并启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#droplet初始化并启动"}},[t._v("#")]),t._v(" droplet初始化并启动")]),t._v(" "),s("h4",{attrs:{id:"gateway签名模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gateway签名模式"}},[t._v("#")]),t._v(" gateway签名模式")]),t._v(" "),s("p",[s("code",[t._v("sophon-gateway")]),t._v("作为中转，会找链接"),s("code",[t._v("sophon-gateway")]),t._v("的wallet进行签名。\n配合"),s("code",[t._v("sophon-auth")]),t._v("、"),s("code",[t._v("venus")]),t._v("、 "),s("code",[t._v("sophon-messager")]),t._v("、"),s("code",[t._v("sophon-gateway")]),t._v("等链服务组件一起为注册到链服务的 "),s("code",[t._v("miner")]),t._v(" 提供市场服务。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("./droplet run "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--cs-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--cs-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("shared-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--signer-type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gateway"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--gateway-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("生成的服务组件配置参考:")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("ChainService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/192.168.200.21/tcp/45132"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiemwiLCJwZXJtIjoiYWRtaW4iLCJleHQiOiIifQ.3u-PInSUmX-8f6Z971M7JBCHYgFVQrvwUjJfFY03ouQ"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Signer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gateway"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/127.0.0.1/tcp/45132"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoic2hhcmVkLXRva2VuIiwicGVybSI6ImFkbWluIiwiZXh0IjoiIn0.aARqJ_7FSe1KakkBhWlFvsYm-xBLAXBnl9SvTfqsVe8"')]),t._v("\n")])])]),s("p",[t._v("💁 "),s("strong",[s("code",[t._v("shared-token")]),t._v(" 是用于访问其他链服务组件 "),s("code",[t._v("API")]),t._v(" 时的权限验证，由 "),s("code",[t._v("sophon-auth")]),t._v(" 管理，需要 "),s("code",[t._v("admin")]),t._v(" 权限。具体请参考 "),s("a",{attrs:{href:"https://github.com/filecoin-project/venus-docs/blob/master/docs/zh/cs/deploy-a-cs.md#user%E5%8F%8Atoken%E7%94%9F%E6%88%90",target:"_blank",rel:"noopener noreferrer"}},[t._v("sophon-auth token"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("💁 "),s("strong",[t._v("如果链服务组件没有"),s("a",{attrs:{href:"https://github.com/ipfs-force-community/sophon-gateway/blob/master/docs/zh/%E5%BF%AB%E9%80%9F%E5%90%AF%E7%94%A8.md#%E4%BD%BF%E7%94%A8-gateway-%E4%BB%A3%E7%90%86%E5%AF%B9%E5%85%B6%E4%BB%96%E7%BA%BF%E4%B8%8A%E7%BB%84%E4%BB%B6%E7%9A%84%E8%AF%B7%E6%B1%82",target:"_blank",rel:"noopener noreferrer"}},[t._v("设置统一的入口"),s("OutboundLink")],1),t._v("的话，可以配置文件或者通过命令行 flag 单独设置每一个链服务组件的 Url 和 Token 。具体请参考 "),s("a",{attrs:{href:"https://github.com/filecoin-project/venus-docs/blob/master/docs/zh/cs/deploy-a-cs.md#user%E5%8F%8Atoken%E7%94%9F%E6%88%90",target:"_blank",rel:"noopener noreferrer"}},[t._v("sophon-auth token"),s("OutboundLink")],1)])]),t._v(" "),s("h5",{attrs:{id:"单独为每个链服务组件设置-url-和-token"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单独为每个链服务组件设置-url-和-token"}},[t._v("#")]),t._v(" 单独为每个链服务组件设置 Url 和 Token")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("./droplet run "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--messager-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--cs-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("shared-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--signer-type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gateway"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--gateway-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("生成的服务组件配置参考:")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("ChainService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiemwiLCJwZXJtIjoiYWRtaW4iLCJleHQiOiIifQ.3u-PInSUmX-8f6Z971M7JBCHYgFVQrvwUjJfFY03ouQ"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Node")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/192.168.200.151/tcp/3455"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Messager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/127.0.0.1/tcp/39812"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("AuthNode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://127.0.0.1:8989"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Signer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gateway"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/127.0.0.1/tcp/45132"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoic2hhcmVkLXRva2VuIiwicGVybSI6ImFkbWluIiwiZXh0IjoiIn0.aARqJ_7FSe1KakkBhWlFvsYm-xBLAXBnl9SvTfqsVe8"')]),t._v("\n\n")])])]),s("h4",{attrs:{id:"venus-wallet-签名模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#venus-wallet-签名模式"}},[t._v("#")]),t._v(" "),s("code",[t._v("venus-wallet")]),t._v(" 签名模式")]),t._v(" "),s("p",[t._v("💁 "),s("strong",[t._v("签名用独立的"),s("code",[t._v("venus-wallet")]),t._v("组件，则配置为 "),s("code",[t._v("venus-wallet")]),t._v("的监听地址及具有签名权限的 "),s("code",[t._v("token")]),t._v(".")])]),t._v(" "),s("p",[s("code",[t._v("venus-wallet")]),t._v(" 生成具有签名权限的 "),s("code",[t._v("token")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ ./venus-wallet auth api-info --perm"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("sign\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBbGxvdyI6WyJyZWFkIiwid3JpdGUiLCJzaWduIl19.Vr-OP7RNOozf6XXZuahpk-ZGA7IDa5NJjmU9L_znJ-0:/ip4/127.0.0.1/tcp/5678/http\n")])])]),s("p",[t._v("初始化并启动")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('./droplet run \\\n--cs-url=/ip4/<ip>/tcp/<port> \\\n--cs-token=<shared-token> \\\n--signer-type="wallet" \\\n--signer-url=/ip4/<ip>/tcp/<port> \\\n--signer-token=<token of venus-wallet> \n')])])]),s("p",[t._v("生成的服务组件配置参考:")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("ChainService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/192.168.200.21/tcp/45132"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiemwiLCJwZXJtIjoiYWRtaW4iLCJleHQiOiIifQ.3u-PInSUmX-8f6Z971M7JBCHYgFVQrvwUjJfFY03ouQ"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Signer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wallet"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/127.0.0.1/tcp/5678/http"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# wallet生成的token")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBbGxvdyI6WyJyZWFkIiwid3JpdGUiLCJzaWduIl19.IVBGlmRW__6g4QGbb1D1Jtr1oyMM6Sqs1tj1GDGR5EQ"')]),t._v("\n")])])]),s("h4",{attrs:{id:"链接lotus启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#链接lotus启动"}},[t._v("#")]),t._v(" 链接lotus启动")]),t._v(" "),s("p",[t._v("配合 "),s("code",[t._v("lotus fullnode")]),t._v(" 的启动方式。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('./droplet run \\\n--node-url=/ip4/<ip>/tcp/<port> \\\n--cs-token=<token of lotus> \\\n--signer-type="lotusnode"\n')])])]),s("p",[t._v("生成的服务组件配置参考:")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Node")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/127.0.0.1/tcp/1234"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBbGxvdyI6WyJyZWFkIiwid3JpdGUiLCJzaWduIiwiYWRtaW4iXX0.Ne3JsfHHhN6BgDtdsvLYfUaRC3eJPH_7KrBsMRBdplc"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Messager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Signer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lotusnode"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/127.0.0.1/tcp/1234"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBbGxvdyI6WyJyZWFkIiwid3JpdGUiLCJzaWduIiwiYWRtaW4iXX0.Ne3JsfHHhN6BgDtdsvLYfUaRC3eJPH_7KrBsMRBdplc"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("AuthNode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Url")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Token")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n")])])]),s("p",[t._v("💁 "),s("strong",[t._v("初始化命令执行成功后将会生成"),s("code",[t._v("droplet repo")]),t._v(",在使用时需根据实际环境配置。")])]),t._v(" "),s("p",[s("code",[t._v("droplet")]),t._v(" 首次启动时会生成配置项，默认目录为: "),s("code",[t._v("~/.droplet/config.toml")]),t._v(",可以根据实际情况，对配置文件进行设置。具体配置文件的解释请参考："),s("RouterLink",{attrs:{to:"/zh/operation/droplet配置解释.html"}},[t._v("droplet配置解释")]),t._v(" "),s("em",[t._v("tips:")]),t._v(" 修改完配置文件之后需要重启"),s("code",[t._v("droplet")]),t._v("服务：")],1),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./droplet run "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" droplet.log "),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("已经生成 "),s("code",[t._v("repo")]),t._v(" 之后，初始化所需的参数被写入配置文件，故后续启动无需再加。")])]),t._v(" "),s("h3",{attrs:{id:"添加-miner"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加-miner"}},[t._v("#")]),t._v(" 添加 miner")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("./droplet actor upsert t01041\n")])])]),s("h3",{attrs:{id:"设置droplet信息到网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置droplet信息到网络"}},[t._v("#")]),t._v(" 设置droplet信息到网络")]),t._v(" "),s("ul",[s("li",[t._v("查询 "),s("code",[t._v("droplet")]),t._v(" 的对等节点监听地址，获取"),s("code",[t._v("addrs")]),t._v("和"),s("code",[t._v("peer-id")]),t._v("值。")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet net listen\n\n/ip4/127.0.0.1/tcp/58418/p2p/12D3KooWQftXTGFBKooKuyaNkugapUzi4VmjxEKTgkpsNCQufKBK\n/ip4/192.168.19.67/tcp/58418/p2p/12D3KooWQftXTGFBKooKuyaNkugapUzi4VmjxEKTgkpsNCQufKBK\n/ip6/::1/tcp/49770/p2p/12D3KooWQftXTGFBKooKuyaNkugapUzi4VmjxEKTgkpsNCQufKBK\n")])])]),s("ul",[s("li",[t._v("添加一个 "),s("code",[t._v("miner")]),t._v(" 到droplet中，用于管理这个节点存储和检索使用")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet actor upsert --account test-1041 f01041\n")])])]),s("p",[s("code",[t._v("--account")]),t._v("可以随意取名，用于标记"),s("code",[t._v("miner")]),t._v("的名称。")]),t._v(" "),s("ul",[s("li",[t._v("将 "),s("code",[t._v("miners")]),t._v(" 的 "),s("code",[t._v("Multiaddrs")]),t._v(" 和 "),s("code",[t._v("peer-id")]),t._v(" 设置为 "),s("code",[t._v("droplet")]),t._v(" 的 "),s("code",[t._v("Multiaddrs")]),t._v(" 和 "),s("code",[t._v("peer-id")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet actor set-addrs --miner"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("t01041 /ip4/192.168.19.67/tcp/58418\nRequested multiaddrs change "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" message bafy2bzaceceqgxmiledunzjwbajpghzzn4iibvxhoifsrz4q2grzsirgznzdg\n\n./droplet actor set-peer-id --miner"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("f01041 12D3KooWQftXTGFBKooKuyaNkugapUzi4VmjxEKTgkpsNCQufKBK\n  Requested peerid change "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" message bafy2bzacea4ruzf4hvyezzhjkt6hnzz5tpk7ttuw6jmyoadqasqtujypqitp2\n")])])]),s("ul",[s("li",[t._v("等待消息上链后，查看 "),s("code",[t._v("miner")]),t._v(" 的代理信息")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet actor info --miner t01041\npeers: 12D3KooWQftXTGFBKooKuyaNkugapUzi4VmjxEKTgkpsNCQufKBK\naddr: /ip4/192.168.19.67/tcp/58418\n")])])]),s("h3",{attrs:{id:"挂单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#挂单"}},[t._v("#")]),t._v(" 挂单")]),t._v(" "),s("h4",{attrs:{id:"存储挂单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#存储挂单"}},[t._v("#")]),t._v(" 存储挂单")]),t._v(" "),s("p",[t._v("SP设置订单存储订单的价格和存储文件大小限制等信息。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet storage ask "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" --price"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".01fil --verified-price"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".02fil --min-piece-size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("512b --max-piece-size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("512M t01041\n")])])]),s("p",[t._v("可以通过命令行工具检查定价信息：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet storage ask get t01041\nPrice per GiB/Epoch  Verified  Min. Piece Size "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("padded"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  Max. Piece Size "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("padded"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  Expiry "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Epoch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  Expiry "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Appx. Rem. Time"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  Seq. No.\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.01")]),t._v(" FIL             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.02")]),t._v(" FIL  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("512")]),t._v(" B                     "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("521")]),t._v(" MiB                     "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("161256")]),t._v("          719h59m0s                 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])]),s("h4",{attrs:{id:"检索挂单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索挂单"}},[t._v("#")]),t._v(" 检索挂单")]),t._v(" "),s("ul",[s("li",[t._v("设置收款地址")])]),t._v(" "),s("p",[t._v("Droplet 中的每一个 miner 都有对应的配置, 其中 "),s("code",[t._v("RetrievalPaymentAddress")]),t._v(" 配置的是 miner 的检索收款地址。")]),t._v(" "),s("p",[t._v("示例配置如下:")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("Miners")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("Addr")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"t01002"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("RetrievalPaymentAddress")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"f3umdpich3a7xpm3bgtn4cr3k3w7auck2waw4pk76vye5tqm7zxeaq5yuewy75p63gzc5bhzhmfyhuyltcro4a"')]),t._v("\n\n")])])]),s("ul",[s("li",[t._v("设置订单价格")])]),t._v(" "),s("p",[t._v("设置值默认的订单价格")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet retrieval ask "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" f01002\n")])])]),s("p",[t._v("同时，也可以设置数据检索订单的价格，不设置时，默认为0.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet retrieval ask "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--price "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".02fil "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--unseal-price "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".01fil "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--payment-interval 1MB "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nf01002\n")])])]),s("h2",{attrs:{id:"droplet-client"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#droplet-client"}},[t._v("#")]),t._v(" droplet-client")]),t._v(" "),s("h3",{attrs:{id:"droplet-client初始化并启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#droplet-client初始化并启动"}},[t._v("#")]),t._v(" droplet-client初始化并启动")]),t._v(" "),s("p",[s("code",[t._v("droplet-client")]),t._v(" 正常运行需要同步节点、签名节点（"),s("code",[t._v("venus fullnode")]),t._v(" 和 "),s("code",[t._v("lotus fullnode")]),t._v(" 可以作为签名节点）、消息节点（"),s("code",[t._v("venus fullnode")]),t._v(" 和 "),s("code",[t._v("lotus fullnode")]),t._v(" 可以作为消息节点）及 "),s("code",[t._v("droplet")]),t._v("，故其可以灵活配置，只要保证消息能够正常签名并上链即可。")]),t._v(" "),s("p",[s("code",[t._v("droplet-client")]),t._v(" 需要配置 "),s("code",[t._v("--addr")]),t._v(" 用来绑定客户的钱包地址，用于支付客户端抵押和检索费用。")]),t._v(" "),s("p",[t._v("这里介绍常用的三种启动方式：")]),t._v(" "),s("h4",{attrs:{id:"接入-venus-链服务-推荐"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#接入-venus-链服务-推荐"}},[t._v("#")]),t._v(" 接入 "),s("code",[t._v("Venus")]),t._v(" 链服务(推荐)")]),t._v(" "),s("p",[s("code",[t._v("sophon-gateway")]),t._v(" 的签名 "),s("code",[t._v("API")]),t._v(" 只有 "),s("code",[t._v("admin")]),t._v(" 权限才能访问（安全考虑），也就是只有链服务组件才能访问，故 "),s("code",[t._v("droplet-client")]),t._v(" 无法使用，所以用本地的 "),s("code",[t._v("venus-wallet")]),t._v(" 进行签名。")]),t._v(" "),s("p",[s("code",[t._v("droplet-client")]),t._v("是直连"),s("code",[t._v("venus-wallet")]),t._v("进行本地签名，"),s("code",[t._v("--addr")]),t._v("必须指定"),s("code",[t._v("venus-wallet")]),t._v("有的地址才可以。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet-client run "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("venus_ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" \n--messager-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("sophon-messager_ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("user-read-or-write-permission-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--signer-type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("wallet "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--signer-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("venus-wallet_ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--signer-toke"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("wallet-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--addr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("signer address"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n")])])]),s("blockquote",[s("p",[s("code",[t._v("venus-wallet")]),t._v(" 生成具有签名权限的 "),s("code",[t._v("token")]),t._v(" 请参考上文.")])]),t._v(" "),s("h4",{attrs:{id:"连接-venus-fullnode-启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#连接-venus-fullnode-启动"}},[t._v("#")]),t._v(" 连接 "),s("code",[t._v("venus fullnode")]),t._v(" 启动")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet-client run "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("venus_ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" \n--node-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("node-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--signer-type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("wallet "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--addr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("signer address"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n")])])]),s("h4",{attrs:{id:"连接-lotus-fullnode-启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#连接-lotus-fullnode-启动"}},[t._v("#")]),t._v(" 连接 "),s("code",[t._v("lotus fullnode")]),t._v(" 启动")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet-client run "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("venus_ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(" \n--node-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("node-token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--signer-type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("lotusnode "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--addr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("signer address"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n")])])]),s("p",[t._v("这些配置项也可以在配置文件中设置，参见"),s("RouterLink",{attrs:{to:"/zh/operation/droplet-client配置解释.html"}},[t._v("droplet-client配置")])],1),t._v(" "),s("h3",{attrs:{id:"存储订单-发单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#存储订单-发单"}},[t._v("#")]),t._v(" 存储订单（发单）")]),t._v(" "),s("h4",{attrs:{id:"在线订单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在线订单"}},[t._v("#")]),t._v(" 在线订单")]),t._v(" "),s("h5",{attrs:{id:"_1-导入待存储的数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-导入待存储的数据"}},[t._v("#")]),t._v(" 1. 导入待存储的数据")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet-client data "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("file path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nImport "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1642491708527303001")]),t._v(", Root bafk2bzacedgv2xqys5ja4gycqipmg543ekxz3tjj6wwfexda352n55ahjldja\n")])])]),s("h5",{attrs:{id:"_2-选择挂单-询价"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-选择挂单-询价"}},[t._v("#")]),t._v(" 2. 选择挂单(询价)")]),t._v(" "),s("p",[t._v("测试连通性，使用 "),s("code",[t._v("droplet-client")]),t._v(" 来查询 "),s("code",[t._v("miner")]),t._v(" 挂单信息：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet-client storage asks query f01041 \nAsk: t01041\nPrice per GiB: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.02")]),t._v(" FIL\nVerified Price per GiB: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.01")]),t._v(" FIL\nMax Piece size: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" MiB\nMin Piece size: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("512")]),t._v(" B\n")])])]),s("h5",{attrs:{id:"_3-发起存储订单-发单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-发起存储订单-发单"}},[t._v("#")]),t._v(" 3. 发起存储订单（发单）")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("/droplet-client storage deals init\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输入需要存储的数据的cid, `./droplet-client data local`命令查看")]),t._v("\nData CID "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("from lotus client "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": bafk2bzacedgv2xqys5ja4gycqipmg543ekxz3tjj6wwfexda352n55ahjldja\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(" calculating data size\nPieceCid:  baga6ea4seaqpz47j4kqdiixpehmzk3uw5c4cmqvs5iyi7xf7rwkepfhdvowdiai  PayLoadSize: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("809")]),t._v(" PieceSize: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输入数据存储周期")]),t._v("\nDeal duration "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("days"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("180")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输入接单的miner id")]),t._v("\nMiner Addresses "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(" f0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", none to find: t01041\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(" querying miner asks\n-----\nProposing from t16qnfduxzpneb2m3rbdasvhgk7rmmo32zpiypkaq\n\tBalance: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9499.999999856612207905")]),t._v(" FIL\nPiece size: 1KiB "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Payload size: 809B"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nDuration: 4320h0m0s\nTotal price: ~0.0098876953124352 FIL "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.000000019073486328")]),t._v(" FIL per epoch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nVerified: "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 确认是否接受订单价格")]),t._v("\nAccept "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("yes/no"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yes")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(" executing\nDeal "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t01051"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" CID: bafyreihiln2ha6eaaos7kuhwpnvjvjlxmjnpsklym6hhucu2z776bf2or4\n")])])]),s("p",[t._v("然后等待订单消息上链，以及存储提供商完成数据封装即可。")]),t._v(" "),s("p",[s("code",[t._v("droplet-client")]),t._v(" 查看订单:")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet-client storage deals list\nDealCid      DealId  Provider  State                          On Chain?  Slashed?  PieceCID     Size    Price                    Duration  Verified\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".76bf2or4  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("       t01051    StorageDealCheckForAcceptance  N          N         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".dvowdiai  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1016")]),t._v(" B  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.00992212295525724")]),t._v(" FIL  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("520205")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  Message: Provider state: StorageDealPublish\n")])])]),s("h4",{attrs:{id:"离线订单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#离线订单"}},[t._v("#")]),t._v(" 离线订单")]),t._v(" "),s("h5",{attrs:{id:"_1-导入订单存储文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-导入订单存储文件"}},[t._v("#")]),t._v(" 1. 导入订单存储文件")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet-client data "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),t._v(" ./README.md\nImport "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1642643014364955003")]),t._v(", Root bafk2bzaceaf4sallirkt63fqrojz5gaut7akiwxrclcsymqelqad7man3hc2c\n")])])]),s("h5",{attrs:{id:"_2-转为car文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-转为car文件"}},[t._v("#")]),t._v(" 2. 转为CAR文件")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet-client data generate-car ./README.md ./readme.md.car\n")])])]),s("h5",{attrs:{id:"_3-计算car文件的cid和piece-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-计算car文件的cid和piece-size"}},[t._v("#")]),t._v(" 3. 计算CAR文件的"),s("code",[t._v("CID")]),t._v("和"),s("code",[t._v("Piece size")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet-client data commP ./readme.md.car\nCID:  baga6ea4seaqfewgysi3n3cjylkbfknr56vbemb2gwjfvpctqtjgpdweu7o3d6mq\nPiece size:  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.969")]),t._v(" KiB\n")])])]),s("h5",{attrs:{id:"_4-发起订单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-发起订单"}},[t._v("#")]),t._v(" 4. 发起订单")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./droplet-client storage deals init "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--manual-piece-cid"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("baga6ea4seaqfewgysi3n3cjylkbfknr56vbemb2gwjfvpctqtjgpdweu7o3d6mq "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--manual-piece-size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4064")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nbafk2bzaceaf4sallirkt63fqrojz5gaut7akiwxrclcsymqelqad7man3hc2c "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nf01051 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(".01fil "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("518400")]),t._v("\nbafyreiecguaxgtmgcanfco6huni4d6h6zs3w3bznermmiurtdos7r6hftm\n")])])]),s("ul",[s("li",[s("code",[t._v("manual-piece-cid")]),t._v(": 在第3步计执行"),s("code",[t._v("data commP")]),t._v("后输出的"),s("code",[t._v("CID")])]),t._v(" "),s("li",[s("code",[t._v("manual-piece-size")]),t._v(": 在第3步执行"),s("code",[t._v("data commP")]),t._v("后输出的"),s("code",[t._v("Piece size")]),t._v(".需要注意的是, 在使用这个参数时, 这个值需要转换成"),s("code",[t._v("byte")]),t._v("的大小, 在这里为3.969kib转换成byte的大小是4064.\n之后4个参数分别是:")]),t._v(" "),s("li",[t._v("第一步执行"),s("code",[t._v("import")]),t._v("命令后输入的"),s("code",[t._v("Root")])]),t._v(" "),s("li",[t._v("矿工ID")]),t._v(" "),s("li",[t._v("协商支付订单的费用"),s("code",[t._v("0.01fil")]),t._v(", **这个值必须大于旷工设置的"),s("code",[t._v("storage ask")]),t._v("中的最小值, 不然订单会被拒绝掉.")]),t._v(" "),s("li",[t._v("合约周期, 必须大于等于180天, 这个值也需要换成epoch为单位, 每个epoch=30秒, 示例中:518400 = 180天.")])]),t._v(" "),s("p",[t._v("最后的输出"),s("code",[t._v("bafyreidfs2w7lxacq6zpqck7q4zimyitidxyahojf7dbbuz5zr7irdlmqa")]),t._v("为propose的cid.\n线上订单一样, 此时可以通过droplet-client查看deal信息, 订单的最后状态会停止在"),s("code",[t._v("StorageDealWaitingForData")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet-client storage deals list\nDealCid      DealId  Provider  State                          On Chain?        Slashed?  PieceCID     Size       Price                    Duration  Verified  \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".s7r6hftm  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("       t01051    StorageDealCheckForAcceptance  N                N         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".u7o3d6mq  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.969")]),t._v(" KiB  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5196.63")]),t._v(" FIL              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("519663")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("     \n  Message: Provider state: StorageDealWaitingForData\n")])])]),s("p",[t._v("💁 "),s("strong",[t._v("如果 "),s("code",[t._v("droplet-client")]),t._v(" 出现下面的内容:")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-01-20T12:47:27.966+0800\tERROR\tstoragemarket_impl\tclientstates/client_states.go:324\tdeal bafyreif2k2e4acraxk33z3llwo5gqmk32tfrdj2kocjanojbfbf6vj72vm failed: adding market funds failed: estimating gas used: message execution failed: "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" SysErrInsufficientFunds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("说明钱包余额不足,调用命令 "),s("code",[t._v("./droplet-client actor-funds add --address f0xxx --from f3xxxxxxxxxx 100fil")]),t._v(" 充值后重新执行命令.")]),t._v(" "),s("h5",{attrs:{id:"_5-导入离线订单的数据文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-导入离线订单的数据文件"}},[t._v("#")]),t._v(" 5. 导入离线订单的数据文件")]),t._v(" "),s("p",[t._v("需要将之前第2步生成的"),s("code",[t._v(".car")]),t._v("文件线下传输到droplet, 并通过droplet命令导入数据:")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet storage deal import-data bafyreiecguaxgtmgcanfco6huni4d6h6zs3w3bznermmiurtdos7r6hftm ./readme.md.car\n")])])]),s("p",[t._v("再次查看状态, 订单状态更新为"),s("code",[t._v("StorageDealPublishing")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet-client storage deals list\nDealCid      DealId  Provider  State                          On Chain?        Slashed?  PieceCID     Size       Price                    Duration  Verified  \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".s7r6hftm  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("       t01051    StorageDealCheckForAcceptance  N                N         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".u7o3d6mq  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.969")]),t._v(" KiB  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5196.63")]),t._v(" FIL              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("519663")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("     \nMessage: Provider state: StorageDealPublishing\n")])])]),s("p",[t._v("最后等待订单状态变化为"),s("code",[t._v("StorageDealAwaitingPreCommit")]),t._v(" 就可以进行订单数据的封装了。")]),t._v(" "),s("h1",{attrs:{id:"提交数据检索订单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#提交数据检索订单"}},[t._v("#")]),t._v(" 提交数据检索订单")]),t._v(" "),s("p",[t._v("用户通过 "),s("code",[t._v("minerID")]),t._v(" 和 "),s("code",[t._v("Data CID")]),t._v(" 就可以发起数据检索订单")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("./droplet-client retrieval retrieve --provider t01020 bafk2bzacearla6en6crpouxo72d5lhr3buajbzjippl63bfsd2m7rsyughu42 test.txt\nRecv "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" B, Paid "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" FIL, Open "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("New"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", 0s\nRecv "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" B, Paid "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" FIL, DealProposed "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("WaitForAcceptance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", 16ms\nRecv "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" B, Paid "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" FIL, DealAccepted "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Accepted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", 26ms\nRecv "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" B, Paid "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" FIL, PaymentChannelSkip "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ongoing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", 27ms\nRecv "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.479")]),t._v(" KiB, Paid "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" FIL, BlocksReceived "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ongoing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", 30ms\nRecv "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.479")]),t._v(" KiB, Paid "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" FIL, AllBlocksReceived "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BlocksComplete"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", 33ms\nRecv "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.479")]),t._v(" KiB, Paid "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" FIL, Complete "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CheckComplete"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", 35ms\nRecv "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.479")]),t._v(" KiB, Paid "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" FIL, CompleteVerified "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FinalizingBlockstore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", 36ms\nRecv "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.479")]),t._v(" KiB, Paid "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" FIL, BlockstoreFinalized "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Completed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", 36ms\nSuccess\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);